(()=>{"use strict";const e="https://api.themoviedb.org/3/",t="33949e951ef79e9487d72ee006ef7f98",s="http://image.tmdb.org/t/p/",n=async e=>(await fetch(e)).json(),o=document.querySelector(".loader");async function a(){let o=[];const a=`${e}genre/movie/list?api_key=${t}&language=en-US&page=1`,i=await n(a),l=document.getElementById("movie-rows");l.innerHTML="",i.genres.forEach((async(a,r)=>{const c=`${e}discover/movie?api_key=${t}&with_genres=${a.id}&language=en-US&include_adult=false&page=1`,d=await n(c);o.push(d);let u=`<div class= 'movie-container'>\n    <div class = 'section-title'>${a.name}</div>\n    <div class="row"><span  class="arrow__btn left-arrow">‹</span>`;u+=d.results.map((e=>`<div class='card'><img class="movie-poster" loading="lazy" \n      src= '${s}w780${e.backdrop_path}' data-movieid=${e.id}>\n      <span class='movie-title'>${e.title}<span>\n      </div>`)),u+='<span  class="arrow__btn right-arrow">›</span></div> </div>',l.innerHTML+=u,r==i.genres.length-1&&Promise.all(o).then((e=>{m()}))}))}document.addEventListener("DOMContentLoaded",(()=>{u(),setTimeout((()=>{a()}),1500)}));let i=0,l=0;var r=document.getElementsByClassName("search-box-icon")[0],c=document.getElementsByClassName("search-box")[0];let d=!1;r.addEventListener("click",(function(){c.classList.toggle("active")})),document.getElementById("search-movies").addEventListener("keyup",function(o,r){let c;return function(){c&&clearTimeout(c),c=setTimeout((()=>{!function(){let o=document.getElementById("search-movies").value;if(""==o)return d=!1,void a();const r=document.getElementById("movie-rows");r.innerHTML="",i=1,d=!0,u(),setTimeout((async()=>{try{const a=`${e}search/movie?api_key=${t}&language=en-US&query=${o}&include_adult=false&page=1`,i=await n(a);l=i.total_pages;let c,d="",u=0;for(;u<i.results.length;u++){let e="<div class= 'search-container'><div class=\"search-row\">";for(c=u;c<u+4;c++)e+=`<div class='card'><img  loading="lazy" src= '${s}w780${i.results[c].backdrop_path}' onerror="this.onerror=null; this.src='./img/No-Image.png'">\n          <span class='movie-title'>${i.results[c].title}<span>\n          </div>`;u=c-1,e+="</div></div>",d+=e}r.innerHTML=d,console.log(i)}catch(e){console.log(e.message)}finally{m()}}),1e3)}()}),2e3)}}());const m=()=>{o.classList.remove("show")},u=()=>{o.classList.add("show")};document.querySelector("#movie-rows").addEventListener("click",(e=>{const t=e.target;if(t.className="movie-poster"){const e=t.dataset.movieid;window.location.href=`/moviedetail.html?movie=${e}`}}));const g=document.getElementById("movie-rows");let v=new IntersectionObserver((function(o){o[0].intersectionRatio>0&&d&&g.hasChildNodes&&function(){const o=document.getElementById("movie-rows");let a=document.getElementById("search-movies").value;(0==l||i<l)&&(i++,u(),setTimeout((async()=>{try{const r=`${e}search/movie?api_key=${t}&language=en-US&query=${a}&include_adult=false&page=${i}`,c=await n(r);0==l&&(l=c.total_pages);let d,u="",g=0;for(;g<c.results.length;g++){let e="<div class= 'search-container'><div class=\"search-row\">";for(d=g;d<g+4;d++)e+=`<div class='card'><img loading="lazy" src= '${s}w780${c.results[d].backdrop_path}' onerror="this.onerror=null; this.src='./img/No-Image.png'">\n            <span class='movie-title'>${c.results[d].title}<span>\n            </div>`;g=d-1,e+="</div></div>",u+=e}o.innerHTML+=u,console.log(c)}catch(e){console.log(e.message)}finally{m()}}),1e3))}()}),{root:null,rootMargin:"0px",threshold:1}),h=document.querySelector("footer");v.observe(h)})();